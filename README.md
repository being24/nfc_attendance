# NFC Attendance Management System

NFCカードリーダーを使用した勤怠管理システムです。

## 目次

- [NFC Attendance Management System](#nfc-attendance-management-system)
  - [目次](#目次)
  - [概要](#概要)
  - [セットアップ](#セットアップ)
    - [必要な環境](#必要な環境)
    - [インストール](#インストール)
  - [使い方](#使い方)
    - [GUIアプリケーション](#guiアプリケーション)
    - [レポート生成](#レポート生成)
      - [基本的な使い方](#基本的な使い方)
      - [コマンドラインオプション](#コマンドラインオプション)
      - [出力例](#出力例)
  - [プロジェクト構成](#プロジェクト構成)

## 概要

このシステムは、NFCカードリーダー（SONY FeliCa）を使用して勤怠管理を行うためのアプリケーションです。

主な機能：
- NFCカードによる出勤・退勤の記録
- GUIによる勤怠管理
- 勤怠時間レポートの生成（9-17時とその他の時間帯を分けて集計）
- CSVファイルへのレポート出力

## セットアップ

### 必要な環境

- Python 3.10以上
- uv (パッケージマネージャー)
- NFCカードリーダー（SONY FeliCa対応）

### インストール

```bash
# 依存パッケージのインストール
uv sync
```

## 使い方

### GUIアプリケーション

NFCカードリーダーを使った勤怠管理のGUIアプリケーションを起動します。

```bash
uv run main.py
```

カードをリーダーにかざすと、自動的に出勤または退勤が記録されます。

### レポート生成

勤怠時間のレポートを生成します。

#### 基本的な使い方

```bash
# 今期（4-9月または10-3月）のレポートを表示
uv run src/report_time.py

# 期間を指定してレポートを表示
uv run src/report_time.py --start 2025-12-01 --end 2026-01-08

# 週間詳細を含めて表示
uv run src/report_time.py --weekly

# CSVファイルに出力
uv run src/report_time.py --csv report.csv

# CSVファイルに出力（期間指定）
uv run src/report_time.py --start 2025-12-01 --end 2026-01-08 --csv report.csv
```

#### コマンドラインオプション

| オプション | 説明                     | デフォルト値                  |
| ---------- | ------------------------ | ----------------------------- |
| `--start`  | 開始日（YYYY-MM-DD形式） | 今期の開始日（4/1または10/1） |
| `--end`    | 終了日（YYYY-MM-DD形式） | 今日                          |
| `--weekly` | 週間詳細を表示           | なし                          |
| `--csv`    | CSVファイル出力パス      | なし（標準出力）              |
| `--db`     | データベースファイルパス | デフォルトのDB                |

#### 出力例

```
=== 勤怠時間レポート (2025-12-01 ～ 2026-01-08) ===

名前             学籍番号      カードID      9-17時   その他   合計    
------------------------------------------------------------------------
山田太郎         12345678     ABCD1234      40.0H    5.0H   45.0H
佐藤花子         12345679     EFGH5678      38.5H    3.5H   42.0H
------------------------------------------------------------------------
合計                                        78.5H    8.5H   87.0H
```

週間詳細表示（`--weekly`オプション使用時）では、各曜日ごとの時間も表示されます。

## プロジェクト構成

```
nfc_attendance/
├── main.py              # GUIアプリケーション
├── src/
│   ├── attendance_reader.py  # NFCカード読み取り
│   ├── calc_time.py          # 勤怠時間計算
│   ├── db.py                 # データベース操作
│   ├── log_config.py         # ログ設定
│   └── report_time.py        # レポート生成
├── test/                # テストコード
├── data/                # データ保存先
└── logs/                # ログファイル
```
